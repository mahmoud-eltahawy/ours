#!/usr/bin/env nu


def "main dev" [] {
  rm ../target/app/ -rf
  cd ../site
  trunk build
  cd ../webls_app
  cargo build
  cd ../target
  mkdir app
  cd app
  cp ../debug/webls_app ./
  {LEPTOS_SITE_ROOT : "../../target/app/site"} | load-env 
  ./webls_app
}

def "main release" [] {
  rm ../target/app/ -rf
  cd ../webls
  ./wl release
  cd ../webls_app
  cargo build --release
  cd ../target
  mkdir app
  cd app
  cp ../release/webls ./
  cp ../release/webls_app ./
  cp -r ../site ./
}

def main [] {}
