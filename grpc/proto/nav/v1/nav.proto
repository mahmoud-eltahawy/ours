syntax = "proto3";
package nav.v1;

service NavService {
  rpc Ls (LsRequest) returns (LsResponse) {}
  rpc FileSize(FileSizeRequest) returns (FileSizeResponse) {}
  rpc Download(DownloadRequest) returns (stream DownloadResponse) {}
  rpc ResumeDownload(ResumeDownloadRequest) returns (stream ResumeDownloadResponse) {}
  rpc Upload(stream UploadRequest) returns (UploadResponse) {}
}

message LsRequest {
  string path = 1;
}

message LsResponse {
  repeated Unit units = 1;
}

message DownloadRequest {
  string path = 1;
}

message ResumeDownloadRequest {
  string path = 1;
  uint64 progress_index = 2;
}

message ResumeDownloadResponse {
  bytes data = 1;
}

message FileSizeRequest {
  string path = 1;
}

message FileSizeResponse {
  uint64 size =1;
}

message DownloadResponse {
  bytes data = 1;
}

message UploadRequest {
  oneof data {
    string path = 1;
    bytes chunk = 2;
  }  
}

message UploadResponse {}

message Unit {
  string path = 1;
  UnitKind kind = 2;
}

enum UnitKind {
  UNIT_KIND_FOLDER = 0;
  UNIT_KIND_VIDEO = 1;
  UNIT_KIND_AUDIO = 2;
  UNIT_KIND_FILE = 3;
}


